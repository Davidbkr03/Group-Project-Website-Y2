@page "/top-bar"
@rendermode InteractiveServer

<div class="top-bar">
                    <div class="logo">
                        <img src="logo.png" alt="Logo" />
                    </div>
                    <div class="profile">
                        <button class="btn-secondary" @onclick="TogglePanel">Show Panel</button>
                    </div>
    <div class="component-container @_componentContainerClass">
        @if (_showPanel)
        {
            <Log_In onClose="TogglePanelAndLoadPosts" />
        }
    </div>
                </div>

@code {
    private bool _showPanel = false;
    private bool _isComponentExiting = false; // New state
    private string _componentContainerClass = ""; // Initially no class
    private string backgroundblur = ""; // New state

    private async Task TogglePanelAndLoadPosts()
    {
        TogglePanel();
    }

    private async void TogglePanel()
    {

        if (_showPanel) // Handle closing the panel
        {
            _isComponentExiting = true;
            _componentContainerClass = ""; // Remove 'show' class immediately for fade-out
            backgroundblur = "";
            await Task.Delay(300); // Wait for fade-out
            _showPanel = false; // Now actually hide the panel
            _isComponentExiting = false;
        }
        else // Handle opening the panel
        {
            _showPanel = true;
            _componentContainerClass = "show"; // Add 'show' class for immediate visibility
            backgroundblur = "main-page-blurred";
        }
        //await LoadPostsAsync();
    }
}
